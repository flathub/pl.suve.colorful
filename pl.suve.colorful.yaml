app-id: pl.suve.colorful

runtime: org.freedesktop.Platform
runtime-version: "23.08"

sdk: org.freedesktop.Sdk
sdk-extensions:
  - org.freedesktop.Sdk.Extension.freepascal

build-options:
  append-path: /usr/lib/sdk/freepascal/bin
  env:
    PPC_CONFIG_PATH: /usr/lib/sdk/freepascal/etc
    FPCDIR: /usr/lib/sdk/freepascal/fpcsrc

command: colorful
finish-args:
  - --socket=wayland
  - --socket=fallback-x11
  - --share=ipc
  - --socket=pulseaudio
  - --device=dri

rename-icon: colorful

modules:
  - name: optipng
    sources:
      - type: archive
        url: https://netcologne.dl.sourceforge.net/project/optipng/OptiPNG/optipng-0.7.8/optipng-0.7.8.tar.gz
        sha256: 25a3bd68481f21502ccaa0f4c13f84dcf6b20338e4c4e8c51f2cefbd8513398c
    buildsystem: autotools
    build-options:
      config-opts: 
        - --with-system-libs
    cleanup:
      - '*'

  - name: vorbis-tools
    buildsystem: autotools
    sources:
      - type: archive
        url: https://downloads.xiph.org/releases/vorbis/vorbis-tools-1.4.2.tar.gz
        sha256: db7774ec2bf2c939b139452183669be84fda5774d6400fc57fde37f77624f0b0
    cleanup:
      - '*'

  - name: colorful
    sources:
      - type: archive
        url: https://github.com/suve/LD25/releases/download/release-2.1/colorful-2.1-source.zip
        sha512: 5abc4d1d7899f560c1a9c84dd0aa4b1da6173afefbe44d73273193b2d3e06c8f1f5a089e04b7457009cdbbdfc5b9b63be75ce93c505c787b6cc0ac2dd8bfdee9

    buildsystem: simple
    build-commands:
      - ./configure.sh --assets=systemwide --compat=v2 --prefix=$FLATPAK_DEST
      - make executable
      - make -j assets
      - make install

    cleanup:
      - /share/man/
